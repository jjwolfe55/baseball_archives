--//Events_View//--
CREATE VIEW events_view AS
SELECT game_id
,event_id
,substr(game_id,8,4) AS day
,substr(game_id,4,4) as year
,substr(game_id,1,3) AS home_team, home_score
,visiting_team, visiting_score
,IF(batting_team = 0,visiting_team,substr(game_id,1,3)) AS batting_team
,IF(batting_team = 0, substr(game_id,1,3), visiting_team) AS pitching_team
,inning
,outs
,balls
,strikes
,lineup_position
,res_batter_id
,res_batter_hand
,res_pitcher_id
,res_pitcher_hand
,first_runner
,runner_removed_for_pinch_runner_on_1st AS pinch_first_runner
,res_pitcher_for_runner_on_1st
,second_runner
,runner_removed_for_pinch_runner_on_2nd AS pinch_second_runner
,res_pitcher_for_runner_on_2nd
,third_runner, runner_removed_for_pinch_runner_on_3rd AS pinch_third_runner
,res_pitcher_for_runner_on_3rd, event_type
,batter_event_flag
,batted_ball_type, IF(batter_dest = 4,1,0) AS batter_run_scored
,rbi_on_play
,sb_for_runner_on_1st_flag, sb_for_runner_on_2nd_flag
,sb_for_runner_on_3rd_flag
,cs_for_runner_on_1st_flag
,cs_for_runner_on_2nd_flag
,cs_for_runner_on_3rd_flag
,po_for_runner_on_1st_flag
,po_for_runner_on_2nd_flag
,po_for_runner_on_3rd_flag
,runner_on_1st_dest
,runner_on_2nd_dest
,runner_on_3rd_dest
FROM events;

--//batter_id//--
CREATE VIEW batter_id AS
SELECT DISTINCT res_batter_id AS batter_id     
,batting_team AS batter_team
,year AS 'year'
FROM events_view
ORDER BY res_batter_id ASC,batting_team ASC;

--//batter_standard//--
CREATE VIEW batter_standard AS 
SELECT DISTINCT a.batter_id        
,a.batter_team
,a.year
,(SUM(CASE WHEN b.ab_flag = 'T' OR b.event_type = 14 OR b.event_type = 15 OR b.event_type = 16 OR b.sf_flag = 'T'THEN 1 ELSE 0 END)) AS pa
,(SUM(CASE WHEN b.ab_flag = 'T' THEN 1 ELSE 0 END)) AS ab
,(SUM(CASE WHEN b.event_type = 20 THEN 1 ELSE 0 END)) AS 1b
,(SUM(CASE WHEN b.event_type = 21 THEN 1 ELSE 0 END)) AS 2b
,(SUM(CASE WHEN b.event_type = 22 THEN 1 ELSE 0 END)) AS 3b
,(SUM(CASE WHEN b.event_type = 23 THEN 1 ELSE 0 END)) AS hr
,(SUM(CASE WHEN b.event_type = 14 THEN 1 ELSE 0 END)) AS bb
,(SUM(CASE WHEN b.event_type = 15 THEN 1 ELSE 0 END)) AS ibb
,(SUM(CASE WHEN b.event_type = 16 THEN 1 ELSE 0 END)) AS hbp
,(SUM(CASE WHEN b.event_type = 3 THEN 1 ELSE 0 END)) AS so
FROM batter_id AS a
JOIN events_view AS b
